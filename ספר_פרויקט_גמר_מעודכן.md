# ספר פרויקט גמר

## מערכת לזיהוי וסיווג רעד פתולוגי באמצעות עיבוד אותות דיגיטלי

**Tremor Detection and Classification System Using Digital Signal Processing**

---

**שם המחבר:** עומר פטיש

**מוסד לימודים:** [שם המכללה/האוניברסיטה]

**בהנחיית:** [שם המנחה] - כמנחה המכללה

**תאריך:** ינואר 2026

**הוגש לשם מילוי חלקי של הדרישות לקבלת תואר**
**"בוגר במדעים B.Sc. בהנדסת חשמל ואלקטרוניקה"**

---

## תקציר

פרויקט זה פותח במסגרת תכן הנדסי במחלקה להנדסת חשמל ואלקטרוניקה, ומציג פתרון טכנולוגי לזיהוי וסיווג רעד פתולוגי (Pathological Tremor) במחלות נוירולוגיות.

רעד פתולוגי הוא סימפטום שכיח במחלות כמו פרקינסון (Parkinson's Disease) ורעד אסנציאלי (Essential Tremor), המשפיע על מיליוני אנשים ברחבי העולם. המערכות הקיימות לאבחון מבוססות על הערכה סובייקטיבית או על ציוד מעבדתי יקר ומסורבל. פרויקט זה מציע חלופה זולה, ניידת ואובייקטיבית.

המערכת המוצעת מורכבת משני מכלולים עיקריים: מערכת רכישת נתונים מבוססת ESP32 וחיישן תנועה MPU6050, ומערכת עיבוד ואנליזה מבוססת Raspberry Pi. החיישן דוגם תאוצה תלת-צירית בקצב 100 Hz, והנתונים עוברים עיבוד אותות דיגיטלי מתקדם הכולל סינון Butterworth, ניתוח ספקטרלי בשיטת Welch, וחישוב מדדים כמותיים.

האלגוריתם מסווג את הרעד על בסיס ניתוח תדרים והספק: רעד מנוחה (Rest Tremor, 3-7 Hz) ורעד אסנציאלי (Essential Tremor, 6-12 Hz). הסיווג מבוסס על יחס הספק (Power Ratio) בין טווחי התדרים.

לצורך אימות האלגוריתם, פותחה מערכת סימולציה מבוססת מנוע DC מבוקר המייצר רעידות בתדרים מוגדרים. האימות בוצע בתנאים ריאליסטיים עם חיישן על האצבע ויד אוחזת במנוע, והראה דיוק גבוה בזיהוי וסיווג סוגי הרעד.

הפרויקט תורם למחקר במספר מישורים: מימוש מערכת זיהוי רעד בעלות נמוכה (~$100), פיתוח אלגוריתם סיווג אוטומטי, ושיטת אימות כמותית באמצעות מנוע מבוקר. המערכת מהווה אב-טיפוס טכנולוגי (Proof of Concept) שעשוי לשמש בעתיד לפיתוח כלים למעקב אחר רעד ומחקר נוסף.

**מילות מפתח:**
רעד פתולוגי, עיבוד אותות דיגיטלי, מחלת פרקינסון, MPU6050, Raspberry Pi, ESP32, סינון Butterworth, ניתוח PSD, Welch's Method, סיווג רעד

---

## תוכן עניינים

### 1. מבוא ........................................................................................ 1

### 2. תיאור המערכת ........................................................................... 2
   2.1 הגדרה פונקציונאלית ................................................................. 2
   2.2 מפרט פונקציונאלי ...................................................................... 3
   2.3 מפרט טכני .................................................................................. 4
      2.3.1 טבלת פירוט מכלולי המערכת ............................................. 4
      2.3.2 תרשים מלבנים .................................................................. 7
      2.3.3 עקרון פעולת המערכת ....................................................... 8

### 3. מטלות ...................................................................................... 9
   3.1 מטלות הנדסיות ברמת מפרט הדרישות ...................................... 9
   3.2 ביצוע המטלות ע"י המתמחה ..................................................... 10
      3.2.1 שלבי התכנון ...................................................................... 10
      3.2.2 תכנון אב ............................................................................ 11
      3.2.3 תכנון חומרה ...................................................................... 15
      3.2.4 תכנון תוכנה ....................................................................... 17
      3.2.5 תרשימי זרימה ................................................................... 19
      3.2.6 מימוש מערכת הרכישה (ESP32) ......................................... 21
      3.2.7 מימוש מערכת העיבוד (Raspberry Pi) ................................. 23
      3.2.8 מימוש מערכת האימות (Motor Simulation) ......................... 25
      3.2.9 בדיקות ותוצאות אימות ...................................................... 27
   3.3 בעיות ואתגרים הנדסיים ............................................................. 30

### 4. סיכום ודיון ................................................................................ 32
   4.1.1 הצורך בפרויקט ..................................................................... 32
   4.1.2 סיכום ומסקנות .................................................................... 32
   4.1.3 תוספות עתידיות .................................................................. 33
   4.1.4 עמידה בדרישות ................................................................... 34

### 5. סימוכין ...................................................................................... 35

### נספחים
   נספח א': קוד ESP32 (esp32_usb_serial_safe.ino) ............................ 37
   נספח ב': קוד Raspberry Pi מנתח Offline (offline_analyzer.py) ...... 42
   נספח ג': קוד בקר מנוע (motor_control.py) .................................... 57
   נספח ד': תיעוד שרשרת עיבוד אותות ................................................ 62

---

## תוכן איורים

איור 1: תרשים מלבנים כללי של המערכת ............................................. 7
איור 2: תרשים זרימה - מערכת רכישה (ESP32) .................................. 19
איור 3: תרשים זרימה - מערכת עיבוד (Raspberry Pi) ......................... 20
איור 4: תרשים חיבורים - ESP32 + MPU6050 ..................................... 15
איור 5: תרשים חיבורים - L298N Motor Driver .................................... 26
איור 6: ממשק גרפי - Figure 1 (Filters & Metrics) ................................ 24
איור 7: ממשק גרפי - Figure 2 (Dominant Axis Analysis) ..................... 24
איור 8: ממשק גרפי - Figure 3 (Resultant Vector Analysis) .................. 24
איור 9: ממשק גרפי - Figure 4 (PSD Analysis) ..................................... 24
איור 10: תדרי מנוע לעומת תדר זיהוי - רעד מנוחה .............................. 27
איור 11: תדרי מנוע לעומת תדר זיהוי - רעד אסנציאלי ......................... 28
איור 12: PSD Comparison - Rest vs Essential ..................................... 29
איור 13: Power Ratio Distribution .................................................... 29

---

## תוכן טבלאות

טבלה 1: מכלולי מערכת רכישת נתונים (ESP32) ................................... 5
טבלה 2: מכלולי מערכת עיבוד (Raspberry Pi 4) .................................. 6
טבלה 3: מכלולי מערכת אימות (Motor Simulation) ............................. 6
טבלה 4: פרמטרי סינון Butterworth ................................................... 12
טבלה 5: פרמטרי ניתוח Welch PSD ................................................... 13
טבלה 6: סיכום תוצאות אימות מנוע - רעד מנוחה ................................ 27
טבלה 7: סיכום תוצאות אימות מנוע - רעד אסנציאלי ........................... 28
טבלה 8: סטטוס עמידה בדרישות הפרויקט ......................................... 34

---

## תוכן גרפים

גרף 1: תגובת תדר Butterworth Order 4 - Magnitude .......................... 14
גרף 2: תגובת תדר Butterworth Order 4 - Phase ................................ 14
גרף 3: PSD Analysis - Rest Simulation (4-6 Hz) ................................ 27
גרף 4: PSD Analysis - Essential Simulation (8-10 Hz) ........................ 28
גרף 5: השוואת Band Power - Rest vs Essential .................................. 29

---

## רשימת קיצורים

**ADC** - Analog to Digital Converter
**API** - Application Programming Interface
**CSV** - Comma Separated Values
**DC** - Direct Current
**DMA** - Direct Memory Access
**DSP** - Digital Signal Processing
**FIFO** - First In First Out
**GPIO** - General Purpose Input/Output
**GUI** - Graphical User Interface
**Hz** - Hertz (יחידת תדר)
**I2C** - Inter-Integrated Circuit
**IMU** - Inertial Measurement Unit
**LED** - Light Emitting Diode
**OLED** - Organic Light Emitting Diode
**PC** - Personal Computer
**PSD** - Power Spectral Density
**PWM** - Pulse Width Modulation
**RMS** - Root Mean Square
**RPM** - Revolutions Per Minute
**SPI** - Serial Peripheral Interface
**UART** - Universal Asynchronous Receiver Transmitter
**USB** - Universal Serial Bus
**Wi-Fi** - Wireless Fidelity

---

# .1 מבוא

רעד פתולוגי (Pathological Tremor) הוא אחד הסימפטומים השכיחים ביותר במחלות נוירולוגיות ומשפיע על כ-10 מיליון בני אדם ברחבי העולם. רעד זה מתבטא בתנועות לא רצוניות מתנודדות של איבר או חלק מהגוף, בתדר קבוע יחסית, ויכול להשפיע באופן משמעותי על איכות החיים, היכולת לבצע פעולות יומיומיות ועל העצמאות של החולים.

שני סוגי הרעד הפתולוגי השכיחים ביותר הם:

1. **רעד מנוחה (Rest Tremor)** - מאפיין מחלת פרקינסון, מופיע בעיקר בזמן מנוחה בטווח תדרים 3-7 Hz
2. **רעד אסנציאלי (Essential Tremor)** - מופיע בעיקר בזמן פעילות או החזקת תנוחה, בטווח תדרים 6-12 Hz

אבחון מדויק וזיהוי מוקדם של סוג הרעד הפתולוגי הוא קריטי עבור בחירת טיפול תרופתי מתאים, מעקב אחר התקדמות המחלה, הערכת יעילות הטיפול וקבלת החלטות לגבי התערבויות נוספות.

### השיטות הקיימות כיום לזיהוי רעד:

**1. הערכה קלינית ידנית:**
- מבוססת על שיפוט סובייקטיבי של נוירולוג
- משתמשת בסקאלות כמו UPDRS (Unified Parkinson's Disease Rating Scale)
- בעיות: חוסר אובייקטיביות, תלות בניסיון הרופא, אין מעקב כמותי לאורך זמן

**2. מערכות מעבדתיות מסחריות:**
- מבוססות על חיישנים אלקטרומגנטיים או מצלמות תנועה
- עלות גבוהה מאוד ($50,000-$200,000)
- מסורבלות ונדרש ציוד נייח
- אינן זמינות למרבית המרפאות והחולים

**3. מערכות ניידות מחקריות:**
- במחקרים אקדמיים, פותחו מערכות ניידות מבוססות IMU
- רובן לא הגיעו לשלב מסחרי
- חסרה סטנדרטיזציה בין מערכות שונות

### הצורך בפרויקט זה:

קיים צורך ברור במערכת:
- **זולה** - מבוססת רכיבים פתוחים ונגישים ($100-200)
- **ניידת** - ניתן להפעיל בבית, בקליניקה או במרפאה
- **אובייקטיבית** - מדידות כמותיות חזרתיות
- **ידידותית למשתמש** - אינה דורשת הכשרה מורכבת
- **מבוססת מדעית** - אלגוריתמים מבוססי מחקר בעיבוד אותות

פרויקט זה בא לענות על צורך זה ולהציג פתרון מעשי, זול ויעיל לזיהוי וסיווג רעד פתולוגי.

**הבעיה המרכזית:**
כיצד ניתן לזהות ולסווג באופן אוטומטי, אובייקטיבי ומדויק את סוג הרעד הפתולוגי (Rest vs Essential) באמצעות חיישן תנועה זול ועיבוד אותות דיגיטלי?

**מטרות הפרויקט:**
1. פיתוח מערכת רכישת נתונים מבוססת ESP32 + MPU6050 (דגימה 100 Hz)
2. פיתוח אלגוריתם עיבוד אותות: סינון Butterworth, ניתוח PSD בשיטת Welch
3. פיתוח אלגוריתם סיווג אוטומטי מבוסס Power Ratio
4. פיתוח מערכת אימות מבוססת מנוע DC מבוקר
5. תיעוד מקיף והוכחת עקביות פנימית

---

# .2 תיאור המערכת

## 2.1 הגדרה פונקציונאלית

מערכת אוטומטית לרכישה, עיבוד, ניתוח וסיווג של נתוני תנועת רעד, המספקת מדדים כמותיים ואובייקטיביים לזיהוי והערכת מאפייני רעד בטווחי התדרים השונים (Rest Tremor 3-7 Hz, Essential Tremor 6-12 Hz).

---

## 2.2 מפרט פונקציונאלי

### מערכת רכישת נתונים (ESP32):

1. יכולת קליטת נתוני תאוצה תלת-צירית בקצב 100 Hz
2. יכולת אחסון זמני ב-FIFO buffer (1024 דגימות)
3. יכולת תקשורת USB Serial יציבה (115200 baud)
4. יכולת הצגת סטטוס על תצוגת OLED
5. יכולת בקרת הקלטה (התחלה/עצירה/המשך) באמצעות לחצן
6. יכולת חיווי סטטוס באמצעות נוריות LED
7. יכולת עבודה רציפה למשך 120+ שניות

### מערכת עיבוד ואנליזה (Raspberry Pi):

8. יכולת קליטת נתונים ב-USB Serial בזמן אמת
9. יכולת סינון Butterworth Order 4 בשלושה טווחי תדר
10. יכולת חישוב PSD בשיטת Welch (4s windows, 50% overlap)
11. יכולת חישוב מדדים קליניים (RMS, Power, Frequency)
12. יכולת סיווג אוטומטי לסוגי רעד
13. יכולת ויזואליזציה גרפית MATLAB-style
14. יכולת שמירת נתונים לקבצי CSV
15. יכולת ייצוא גרפים לתמונות

### מערכת אימות (Motor Simulation):

16. יכולת יצירת רעידות בתדרים מוגדרים (0.1 Hz resolution)
17. יכולת הרצת סדרות תדרים אוטומטיות (120s sequences)
18. יכולת בקרת עוצמה (PWM 0-100%)
19. יכולת הפעלה באמצעות לחצן או שורת פקודה

---

## 2.3 מפרט טכני

### 2.3.1 טבלת פירוט מכלולי המערכת

**טבלה 1: מכלולי מערכת רכישת נתונים (ESP32)**

| מספר | שם המכלול | תפקיד | פרמטרים מדידים |
|------|-----------|-------|----------------|
| 1 | מכלול חישה - חיישן תנועה MPU6050 | דגימת תאוצה תלת-צירית (Ax, Ay, Az) בקצב 100 Hz | טווח: ±2g, ±4g, ±8g, ±16g<br>רזולוציה: 16-bit<br>רעש: 0.01 g RMS |
| 2 | מכלול בקרה - ESP32 Development Board | עיבוד ראשוני, ניהול FIFO, תקשורת USB Serial | מעבד: Dual-core 240 MHz<br>זיכרון: 520 KB SRAM<br>תקשורת: USB, I2C, SPI |
| 3 | מכלול תצוגה - OLED 128x64 | הצגת סטטוס, מספר דגימות, זמן הקלטה | גודל: 0.96"<br>רזולוציה: 128x64<br>תקשורת: I2C |
| 4 | מכלול בקרת משתמש - Push Button + LEDs | התחלה/עצירה/המשך הקלטה, חיווי סטטוס | לחצן: Pull-up<br>LED ירוק: הקלטה<br>LED אדום: שגיאה |

**טבלה 2: מכלולי מערכת עיבוד (Raspberry Pi 4)**

| מספר | שם המכלול | תפקיד | פרמטרים מדידים |
|------|-----------|-------|----------------|
| 1 | מכלול בקרה - Raspberry Pi 4 Model B | עיבוד אותות מתקדם, ניתוח PSD, סיווג רעד, ויזואליזציה | מעבד: Quad-core 1.5 GHz<br>זיכרון: 4 GB RAM<br>אחסון: 64 GB SD |
| 2 | מכלול תקשורת USB Serial | קליטת נתונים מ-ESP32 בזמן אמת | קצב: 115200 baud<br>פורמט: "timestamp,ax,ay,az" |
| 3 | מכלול עיבוד אותות | סינון Butterworth, ניתוח PSD, חישוב מדדים | Python 3<br>NumPy, SciPy<br>Matplotlib |

**טבלה 3: מכלולי מערכת אימות (Motor Simulation)**

| מספר | שם המכלול | תפקיד | פרמטרים מדידים |
|------|-----------|-------|----------------|
| 1 | מכלול בקרת מנוע - L298N Motor Driver | בקרת PWM ומהירות מנוע DC | מתח: 12V<br>זרם מקס: 2A<br>PWM: 0-100% |
| 2 | מנוע DC 12V | יצירת רעידות מכניות בתדרים מוגדרים | RPM: 0-3000<br>מומנט: 0.5 Nm |
| 3 | בקר Raspberry Pi 4 | שליטה ב-GPIO, הרצת סדרות תדרים | GPIO 18 (PWM)<br>GPIO 23, 24 (Direction) |

---

## 2.3.2 תרשים מלבנים

```
┌─────────────────────────────────────────────────────────────────────┐
│                    מערכת זיהוי וסיווג רעד פתולוגי                    │
└─────────────────────────────────────────────────────────────────────┘
                                   │
        ┌──────────────────────────┼──────────────────────────┐
        │                          │                          │
        ▼                          ▼                          ▼
┌───────────────┐          ┌───────────────┐          ┌───────────────┐
│  מערכת רכישה   │          │  מערכת עיבוד   │          │ מערכת אימות    │
│    ESP32      │◄────────►│ Raspberry Pi 4│          │ Motor Control │
└───────────────┘   USB    └───────────────┘          └───────────────┘
        │            Serial        │                          │
        │                          │                          │
┌───────▼───────┐          ┌───────▼───────┐          ┌───────▼───────┐
│   MPU6050     │          │  DSP Engine   │          │   L298N       │
│  (Ax,Ay,Az)   │          │ • Butterworth │          │ Motor Driver  │
│   100 Hz      │          │ • Welch PSD   │          │  PWM Control  │
└───────┬───────┘          │ • Classifier  │          └───────┬───────┘
        │                  └───────┬───────┘                  │
        │                          │                          │
┌───────▼───────┐          ┌───────▼───────┐          ┌───────▼───────┐
│  OLED Display │          │  GUI Output   │          │   DC Motor    │
│  LED Status   │          │ 4-Tab MATLAB  │          │ Tremor Sim.   │
│  Button Ctrl  │          │  Interface    │          │  4-10 Hz      │
└───────────────┘          └───────────────┘          └───────────────┘
```

**איור 1: תרשים מלבנים כללי של המערכת**

---

## 2.3.3 עקרון פעולת המערכת

### זרימת נתונים:

**שלב 1: רכישת נתונים (ESP32)**
1. המשתמש לוחץ על לחצן ההתחלה → LED ירוק נדלק
2. חיישן MPU6050 דוגם תאוצה תלת-צירית (Ax, Ay, Az) בקצב 100 Hz
3. הנתונים נשמרים ב-FIFO Buffer (1024 דגימות)
4. כל דגימה מועברת ב-USB Serial בפורמט: "timestamp,ax,ay,az\n"
5. תצוגת OLED מציגה מספר דגימות נוכחי וזמן הקלטה
6. הקלטה נמשכת עד 120 שניות או עד לחיצה על הלחצן

**שלב 2: העברת נתונים (USB Serial)**
1. Raspberry Pi קולט נתונים ב-115200 baud
2. הנתונים נכתבים ל-CSV file בזמן אמת
3. בסיום הקלטה: קובץ CSV מכיל ~12,000 שורות (100 Hz × 120s)

**שלב 3: עיבוד אותות (Raspberry Pi)**
1. טעינת קובץ CSV ופרסור לערכי Ax, Ay, Az
2. הסרת DC offset (gravity removal): `ax_clean = ax - mean(ax)`
3. סינון Butterworth Order 4:
   - 3-12 Hz (Combined tremor band)
   - 3-7 Hz (Rest tremor band)
   - 6-12 Hz (Essential tremor band)
4. חישוב Resultant Vector: `resultant = sqrt(ax² + ay² + az²)`
5. ניתוח PSD בשיטת Welch (4s windows, 50% overlap)
6. חישוב מדדים:
   - RMS per axis and resultant
   - Band Power (trapezoidal integration)
   - Dominant Frequency (peak detection)
   - Power Ratio = Power_Rest / Power_Essential

**שלב 4: סיווג (Classification)**
```python
if power_ratio > 2.0:
    classification = "Rest Tremor (Parkinsonian)"
    confidence = "High"
elif power_ratio < 0.5:
    classification = "Essential Tremor (Postural)"
    confidence = "High"
else:
    classification = "Inconclusive - Requires Clinical Correlation"
    confidence = "Low"
```

**שלב 5: ויזואליזציה (GUI)**
- **Tab 1:** Bode plots + Clinical Metrics table
- **Tab 2:** Dominant Axis Analysis (time-domain)
- **Tab 3:** Resultant Vector Analysis (time-domain)
- **Tab 4:** PSD Analysis + Band Power Comparison

**שלב 6: שמירת נתונים**
- קובץ CSV מקורי נשמר בתיקייה `tremor_data/`
- גרפים מיוצאים כתמונות PNG (אופציונלי)
- לוג ריצה נשמר לקובץ `analysis.log`

---

# .3 מטלות

## 3.1 מטלות הנדסיות ברמת מפרט הדרישות

### מטלות תכנון ואפיון

1. **כתיבת הצעת פרויקט מפורטת**
   - הגדרת מטרות הפרויקט
   - סקירת ספרות וטכנולוגיות קיימות
   - הגדרת דרישות פונקציונאליות וטכניות

2. **בחירת פלטפורמת חומרה**
   - השוואת בקרים שונים (ESP32 vs Arduino vs STM32)
   - בחירת חיישן תנועה (MPU6050 vs ADXL345 vs LSM6DS3)
   - בחירת מחשב עיבוד (Raspberry Pi vs PC)

3. **תכנון ארכיטקטורת המערכת**
   - הגדרת חלוקת תפקידים בין ESP32 ל-Raspberry Pi
   - תכנון פרוטוקול תקשורת
   - תכנון זרימת נתונים

### מטלות פיתוח חומרה

4. **חיבור והגדרת MPU6050**
   - חיווט I2C (SDA, SCL, VCC, GND)
   - קביעת טווח מדידה (±2g)
   - הגדרת קצב דגימה (100 Hz)

5. **חיבור רכיבי ממשק משתמש**
   - תצוגת OLED 128x64 (I2C)
   - לחצן התחלה עם pull-up
   - נוריות LED (ירוק/אדום)

6. **בניית מערכת Motor Simulation**
   - חיווט L298N Motor Driver
   - חיבור מנוע DC 12V
   - חיבור ל-GPIO של Raspberry Pi

### מטלות פיתוח תוכנה

7. **פיתוח firmware לESP32**
   - הגדרת I2C לתקשורת עם MPU6050
   - מימוש FIFO buffer (1024 samples)
   - מימוש USB Serial (115200 baud)
   - מימוש בקרת לחצן ו-LED
   - מימוש תצוגת OLED

8. **פיתוח מנתח offline (offline_analyzer.py)**
   - קליטת נתונים מ-USB Serial
   - מימוש סינון Butterworth Order 4
   - מימוש ניתוח PSD בשיטת Welch
   - חישוב מדדים כמותיים
   - מימוש אלגוריתם סיווג

9. **פיתוח ממשק גרפי MATLAB-style**
   - יצירת 4 לשוניות עצמאיות (tkinter Notebook)
   - פיתוח 4 figures עם matplotlib
   - מימוש navigation toolbar עצמאי לכל figure

10. **פיתוח בקר מנוע (motor_control.py)**
    - בקרת PWM דרך GPIO
    - מימוש שתי סדרות תדרים (Rest, Essential)

### מטלות בדיקות ואימות

11. **בדיקות תקינות מערכת**
    - בדיקת דגימה ב-100 Hz
    - בדיקת תקשורת USB Serial
    - בדיקת סינון וניתוח PSD

12. **אימות עם מנוע**
    - הרצת סדרת Rest (4-6 Hz)
    - הרצת סדרת Essential (8-10 Hz)
    - תיעוד תוצאות

13. **תיעוד מקיף**
    - כתיבת ספר פרויקט
    - כתיבת תיעוד טכני

---

## 3.2 ביצוע המטלות ע"י המתמחה

### 3.2.1 שלבי התכנון

המשימות התחלקו לחמישה שלבים עיקריים:

**שלב 1: מחקר ואפיון (שבועות 1-2)**
- סקירת ספרות על רעד פתולוגי
- מחקר על עיבוד אותות למדידת רעד
- הגדרת דרישות פונקציונאליות

**שלב 2: תכנון ורכישת רכיבים (שבועות 3-4)**
- בחירת רכיבי חומרה
- תכנון ארכיטקטורת תוכנה
- הזמנת רכיבים (ESP32, MPU6050, L298N)

**שלב 3: פיתוח מערכת רכישה (שבועות 5-6)**
- פיתוח firmware לESP32
- בדיקות תקינות חיישן
- אופטימיזציית דגימה

**שלב 4: פיתוח מערכת עיבוד (שבועות 7-9)**
- פיתוח אלגוריתם DSP
- פיתוח ממשק גרפי
- בדיקות והתאמות

**שלב 5: אימות ותיעוד (שבועות 10-12)**
- פיתוח Motor Simulation
- ביצוע בדיקות אימות
- כתיבת תיעוד וספר פרויקט

---

### 3.2.2 תכנון אב

#### בחירת סביבת פיתוח

**ESP32:**
- **IDE:** Arduino IDE 2.0
- **שפת תכנות:** C++ (Arduino Framework)
- **ספריות:**
  - Wire.h (I2C communication)
  - Adafruit_MPU6050.h (sensor driver)
  - Adafruit_SSD1306.h (OLED display)

**Raspberry Pi:**
- **OS:** Raspberry Pi OS (64-bit, Debian-based)
- **שפת תכנות:** Python 3.9+
- **ספריות:**
  - NumPy 1.21+ (numerical computing)
  - SciPy 1.7+ (signal processing)
  - Matplotlib 3.4+ (plotting)
  - Tkinter (GUI)
  - pyserial (USB Serial)

#### בחירת בקרים

**למה ESP32?**
1. **מחיר:** ~$5 (זול מאוד)
2. **ביצועים:** Dual-core 240 MHz (מספק ל-100 Hz)
3. **זיכרון:** 520 KB SRAM (מספיק ל-FIFO buffer)
4. **תקשורת:** I2C built-in, USB Serial native
5. **קהילה:** תמיכה ענקית, ספריות רבות

**למה Raspberry Pi 4?**
1. **ביצועים:** Quad-core 1.5 GHz (מספק לDSP מתקדם)
2. **זיכרון:** 4 GB RAM (מספיק לניתוח גדול)
3. **OS:** Linux מלא עם Python (נוח לפיתוח)
4. **GPIO:** 40 pins (מספיק למנוע + expansion)
5. **USB:** 4 ports (נוח לחיבור ESP32)

#### בחירת חיישן

**למה MPU6050?**

**טבלה 4: השוואת חיישני תנועה**

| קריטריון | MPU6050 | ADXL345 | LSM6DS3 |
|---------|---------|---------|---------|
| מחיר | $3 | $10 | $5 |
| רזולוציה | 16-bit | 13-bit | 16-bit |
| טווח | ±16g | ±16g | ±16g |
| רעש | 0.01 g | 0.004 g | 0.07 g |
| תקשורת | I2C/SPI | I2C/SPI | I2C/SPI |
| תמיכה | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐⭐ |
| **בחירה** | ✅ | ❌ | ❌ |

**החלטה:** MPU6050 נבחר בגלל:
- מחיר נמוך
- תמיכה ענקית (ספריות, דוגמאות, פורומים)
- רזולוציה מספקת (16-bit)
- רעש נמוך מספיק לזיהוי רעד

#### עקרונות עיבוד אותות - רקע תיאורטי

**סינון Butterworth - למה נדרש?**

אות הפלט מחיישן MPU6050 מכיל:
1. **רכיב DC (כבידה):** ~9.8 m/s² בכיוון הכבידה
2. **רעד פתולוגי:** 3-12 Hz - זה מה שאנחנו רוצים!
3. **תנועות רצוניות:** <3 Hz - צריך להסיר
4. **רעש תדר גבוה:** >12 Hz - צריך להסיר

**מסנן Butterworth - מדוע נבחר?**
1. **Flat Passband:** אין אדוות (ripples) בטווח המעבר
2. **Smooth Roll-off:** ירידה הדרגתית בתדרים מחוץ לטווח
3. **Zero-Phase Filtering:** שימוש ב-`filtfilt()` שומר על פאזה

**טבלה 5: פרמטרי סינון Butterworth**

| Filter Name | Low Cutoff | High Cutoff | Order | Roll-off | Purpose |
|-------------|------------|-------------|-------|----------|---------|
| Combined | 3 Hz | 12 Hz | 4 | 48 dB/octave | סינון כללי של רעד |
| Rest Band | 3 Hz | 7 Hz | 4 | 48 dB/octave | בידוד רעד מנוחה |
| Essential Band | 6 Hz | 12 Hz | 4 | 48 dB/octave | בידוד רעד אסנציאלי |

**ניתוח PSD - שיטת Welch:**

**למה Welch's Method?**
1. **הפחתת רעש:** חלוקה לחלונות + מיצוע מקטינים את השונות
2. **Trade-off:** רזולוציה נמוכה יותר אבל אמינות גבוהה יותר
3. **סטנדרט:** שיטה מקובלת במחקר רפואי

**טבלה 6: פרמטרי ניתוח Welch PSD**

| Parameter | Value | Justification |
|-----------|-------|---------------|
| Window Length | 4 seconds | רזולוציה: 1/4 = 0.25 Hz |
| Overlap | 50% | איזון בין רזולוציה לשונות |
| Window Type | Hann | מקטין leakage ספקטרלי |
| Sampling Rate | 100 Hz | Nyquist: 50 Hz (מספק ל-12 Hz) |
| Frequency Resolution | 0.25 Hz | מספק להפרדת 3-7 Hz מ-6-12 Hz |

---

### 3.2.3 תכנון חומרה

#### תרשים חיבורים - ESP32 + MPU6050

```
ESP32 Development Board
┌────────────────────────────────┐
│                                │
│  GPIO 21 (SDA) ────────────────┼──── SDA ──── MPU6050
│  GPIO 22 (SCL) ────────────────┼──── SCL ──┤
│  3.3V ─────────────────────────┼──── VCC ──┤
│  GND ──────────────────────────┼──── GND ──┘
│                                │
│  GPIO 4 (SDA2) ────────────────┼──── SDA ──── OLED SSD1306
│  GPIO 15 (SCL2) ───────────────┼──── SCL ──┤
│  3.3V ─────────────────────────┼──── VCC ──┤
│  GND ──────────────────────────┼──── GND ──┘
│                                │
│  GPIO 13 ──────────────────────┼──── Button ──── GND
│  (Internal Pull-up enabled)    │   (Active LOW)
│                                │
│  GPIO 2 ───────────────────────┼──── LED Red ──── Resistor 220Ω ──── GND
│  GPIO 15 ──────────────────────┼──── LED Green ──── Resistor 220Ω ──── GND
│                                │
│  USB Port ─────────────────────┼──── USB Cable ──── Raspberry Pi USB
│                                │
└────────────────────────────────┘
```

**איור 4: תרשים חיבורים - ESP32 + MPU6050**

---

### 3.2.4 תכנון תוכנה

#### ארכיטקטורת תוכנה - ESP32

```
┌─────────────────────────────────────────────────────────┐
│                   ESP32 Firmware                        │
└─────────────────────────────────────────────────────────┘
                         │
        ┌────────────────┼────────────────┐
        │                │                │
        ▼                ▼                ▼
┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│   I2C Driver │  │  USB Serial  │  │  UI Control  │
│   MPU6050    │  │   115200     │  │ Button+OLED  │
└──────┬───────┘  └──────┬───────┘  └──────┬───────┘
       │                 │                 │
       │                 │                 │
       ▼                 ▼                 ▼
┌──────────────────────────────────────────────────┐
│            Main Loop (10ms cycle)                │
│  • Read MPU6050 (100 Hz)                         │
│  • Store in FIFO Buffer (1024 samples)           │
│  • Send via Serial ("timestamp,ax,ay,az\n")      │
│  • Update OLED display                           │
│  • Check button state                            │
│  • Update LED status                             │
└──────────────────────────────────────────────────┘
```

#### ארכיטקטורת תוכנה - Raspberry Pi

```
┌──────────────────────────────────────────────────────────┐
│              Offline Analyzer (offline_analyzer.py)      │
└──────────────────────────────────────────────────────────┘
                            │
        ┌───────────────────┼───────────────────┐
        │                   │                   │
        ▼                   ▼                   ▼
┌───────────────┐  ┌────────────────┐  ┌────────────────┐
│  Data Loader  │  │  DSP Engine    │  │  GUI Engine    │
│  CSV Parser   │  │  scipy.signal  │  │  matplotlib    │
└───────┬───────┘  └────────┬───────┘  └────────┬───────┘
        │                   │                   │
        │                   │                   │
        ▼                   ▼                   ▼
┌───────────────────────────────────────────────────────────┐
│                   Processing Pipeline                      │
│                                                            │
│  1. Load CSV → Parse (timestamp, ax, ay, az)              │
│  2. Remove DC offset → ax_clean = ax - mean(ax)           │
│  3. Butterworth Filter → 3 bands (3-12, 3-7, 6-12 Hz)     │
│  4. Calculate Resultant → sqrt(ax² + ay² + az²)           │
│  5. Welch PSD → freq, psd (4s windows, 50% overlap)       │
│  6. Calculate Metrics → RMS, Power, Frequency              │
│  7. Classify → Rest/Essential (Power Ratio)                │
│  8. Visualize → 4-Tab MATLAB Interface                    │
│  9. Save → CSV + Plots + Log                              │
└───────────────────────────────────────────────────────────┘
```

---

### 3.2.5 תרשימי זרימה

#### תרשים זרימה - מערכת רכישה (ESP32)

```
         ┌─────────┐
         │  START  │
         └────┬────┘
              │
              ▼
      ┌───────────────┐
      │ Initialize:   │
      │ • I2C + MPU   │
      │ • Serial      │
      │ • OLED + LEDs │
      └───────┬───────┘
              │
              ▼
      ┌───────────────────┐
      │ Wait for Button   │◄──────────┐
      │   Press           │           │
      └────────┬──────────┘           │
               │                      │
               ▼                      │
        Button Pressed?               │
         ┌────┴────┐                  │
         │   NO    │──────────────────┘
         └─────────┘
         ┌─────────┐
         │   YES   │
         └────┬────┘
              │
              ▼
      ┌──────────────┐
      │ LED Green ON │
      │ Start Timer  │
      └───────┬──────┘
              │
              ▼
    ┌────────────────────┐
    │ Read MPU6050       │◄─────┐
    │ (ax, ay, az)       │      │
    └─────────┬──────────┘      │
              │                 │
              ▼                 │
    ┌────────────────────┐      │
    │ Send via Serial:   │      │
    │ "time,ax,ay,az\n"  │      │
    └─────────┬──────────┘      │
              │                 │
              ▼                 │
    ┌────────────────────┐      │
    │ Update OLED:       │      │
    │ Samples, Time      │      │
    └─────────┬──────────┘      │
              │                 │
              ▼                 │
       ┌──────────────┐         │
       │ Time < 120s? │         │
       └──────┬───────┘         │
              │                 │
         ┌────┴────┐            │
         │   YES   │────────────┘
         └─────────┘
         ┌─────────┐
         │   NO    │
         └────┬────┘
              │
              ▼
      ┌──────────────┐
      │ LED Green OFF│
      │ Stop Timer   │
      └───────┬──────┘
              │
              ▼
         ┌─────────┐
         │   END   │
         └─────────┘
```

**איור 2: תרשים זרימה - מערכת רכישה (ESP32)**

#### תרשים זרימה - מערכת עיבוד (Raspberry Pi)

```
         ┌─────────┐
         │  START  │
         └────┬────┘
              │
              ▼
      ┌───────────────┐
      │ Load CSV File │
      └───────┬───────┘
              │
              ▼
    ┌─────────────────┐
    │ Parse:          │
    │ time,ax,ay,az   │
    └────────┬────────┘
             │
             ▼
    ┌─────────────────┐
    │ Remove DC:      │
    │ ax-=mean(ax)    │
    └────────┬────────┘
             │
             ▼
    ┌──────────────────┐
    │ Butterworth x3:  │
    │ • 3-12 Hz        │
    │ • 3-7 Hz         │
    │ • 6-12 Hz        │
    └────────┬─────────┘
             │
             ▼
    ┌──────────────────┐
    │ Calc Resultant:  │
    │ sqrt(ax²+ay²+az²)│
    └────────┬─────────┘
             │
             ▼
    ┌──────────────────┐
    │ Welch PSD:       │
    │ 4s win, 50% olap │
    └────────┬─────────┘
             │
             ▼
    ┌──────────────────┐
    │ Calc Metrics:    │
    │ • RMS            │
    │ • Band Power     │
    │ • Dom. Freq      │
    │ • Power Ratio    │
    └────────┬─────────┘
             │
             ▼
       ┌──────────┐
       │ Classify │
       └────┬─────┘
            │
            ▼
    ┌────────────────┐
    │ Power Ratio?   │
    └────┬───────────┘
         │
    ┌────┴─────┬──────────────┬─────────┐
    │          │              │         │
    ▼          ▼              ▼         ▼
  > 2.0    0.5-2.0         < 0.5    Error
  │          │              │         │
  ▼          ▼              ▼         ▼
┌──────┐ ┌──────────┐   ┌──────────┐ ┌──────┐
│ Rest │ │Inconclu- │   │Essential │ │ N/A  │
│      │ │  sive    │   │          │ │      │
└──┬───┘ └──────┬───┘   └────┬─────┘ └──┬───┘
   │            │            │          │
   └────────────┴────────────┴──────────┘
              │
              ▼
    ┌──────────────────┐
    │ Visualize:       │
    │ 4-Tab GUI        │
    └────────┬─────────┘
             │
             ▼
    ┌──────────────────┐
    │ Save Results:    │
    │ • CSV            │
    │ • Plots          │
    │ • Log            │
    └────────┬─────────┘
             │
             ▼
         ┌─────────┐
         │   END   │
         └─────────┘
```

**איור 3: תרשים זרימה - מערכת עיבוד (Raspberry Pi)**

---

### 3.2.6 מימוש מערכת הרכישה (ESP32)

הקוד המלא מופיע בנספח א'. כאן מוצגים העקרונות המרכזיים:

**תכונות מרכזיות:**
- דגימה ב-100 Hz (delay 10ms)
- FIFO buffer אוטומטי של MPU6050
- Low-pass filter חומרה (21 Hz) למניעת aliasing
- תקשורת Serial יציבה (115200 baud)
- חיווי ויזואלי: LED + OLED

---

### 3.2.7 מימוש מערכת העיבוד (Raspberry Pi)

הקוד המלא מופיע בנספח ב'. המבנה כולל:

**שלבי עיבוד עיקריים:**
1. טעינת נתונים מ-CSV
2. הסרת DC offset
3. סינון Butterworth (3 bands)
4. חישוב Resultant Vector
5. ניתוח PSD בשיטת Welch
6. חישוב מדדים כמותיים
7. סיווג לפי Power Ratio
8. ויזואליזציה (4-Tab GUI)

---

### 3.2.8 מימוש מערכת האימות (Motor Simulation)

#### תרשים חיבורים - L298N Motor Driver

```
Raspberry Pi 4
┌────────────────────────────────┐
│                                │
│  GPIO 18 (PWM) ────────────────┼──── ENA ──── L298N Motor Driver
│  GPIO 23 ──────────────────────┼──── IN1 ──┤
│  GPIO 24 ──────────────────────┼──── IN2 ──┤
│  GND ──────────────────────────┼──── GND ──┘
│                                │
└────────────────────────────────┘
                                         │
                                         │
                                         ▼
                                  L298N Motor Driver
                                  ┌──────────────┐
                                  │              │
                       ENA ───────┤ PWM Speed    │
                       IN1 ───────┤ Direction 1  │
                       IN2 ───────┤ Direction 2  │
                       GND ───────┤ Ground       │
                                  │              │
                       12V+ ──────┤ Power In     │
                       12V- ──────┤ Power GND    │
                                  │              │
                       OUT1 ──────┤              ├──── DC Motor (+)
                       OUT2 ──────┤              ├──── DC Motor (-)
                                  │              │
                                  └──────────────┘
```

**איור 5: תרשים חיבורים - L298N Motor Driver**

הקוד המלא מופיע בנספח ג'. המערכת מייצרת סדרות תדרים:
- **Rest Tremor:** 4, 5, 6, 5 Hz (30s כל אחד)
- **Essential Tremor:** 8, 9, 10, 9 Hz (30s כל אחד)

---

### 3.2.9 בדיקות ותוצאות אימות

#### בדיקות תקינות

**בדיקת דגימה ב-100 Hz:**
```
Duration: 60.02 seconds
Samples: 6002
Average sampling rate: 100.03 Hz ✅
```

**בדיקת USB Serial:**
```
Expected: 12000 samples
Received: 12000 samples
Missing: 0 ✅
```

#### אימות עם מנוע

**טבלה 7: תוצאות אימות - רעד מנוחה**

| Segment | Motor Freq | Detected Freq | Error | Classification |
|---------|-----------|---------------|-------|----------------|
| 1 | 4.0 Hz | 4.25 Hz | +0.25 Hz | Rest Tremor ✅ |
| 2 | 5.0 Hz | 5.00 Hz | 0.00 Hz | Rest Tremor ✅ |
| 3 | 6.0 Hz | 5.75 Hz | -0.25 Hz | Rest Tremor ✅ |
| 4 | 5.0 Hz | 5.25 Hz | +0.25 Hz | Rest Tremor ✅ |
| **Power Ratio** | - | **2.11** | - | **Rest ✅** |

**טבלה 8: תוצאות אימות - רעד אסנציאלי**

| Segment | Motor Freq | Detected Freq | Error | Classification |
|---------|-----------|---------------|-------|----------------|
| 1 | 8.0 Hz | 8.00 Hz | 0.00 Hz | Essential ✅ |
| 2 | 9.0 Hz | 9.25 Hz | +0.25 Hz | Essential ✅ |
| 3 | 10.0 Hz | 10.00 Hz | 0.00 Hz | Essential ✅ |
| 4 | 9.0 Hz | 8.75 Hz | -0.25 Hz | Essential ✅ |
| **Power Ratio** | - | **0.22** | - | **Essential ✅** |

**מסקנות:**
- ✅ דיוק זיהוי: ±0.25 Hz (בתוך רזולוציית Welch)
- ✅ דיוק סיווג: 100% בשני התרחישים
- ✅ המערכת robust לדמפינג ביומכני

---

## 3.3 בעיות ואתגרים הנדסיים

### אתגר 1: דיוק דגימה ב-100 Hz

**בעיה:** השימוש ב-`delay(10)` אינו מבטיח דגימה מדויקת בגלל overhead

**פתרון:** שימוש ב-`millis()` למדידה מדויקת

### אתגר 2: חפיפת טווחי תדרים

**בעיה:** Rest (3-7 Hz) ו-Essential (6-12 Hz) חופפים ב-6-7 Hz

**פתרון:** 
- שמירה על טווחים קליניים
- שימוש ב-Power Ratio לסיווג
- Deviation Analysis לזיהוי פיקים באזור החפיפה

### אתגר 3: חישוב Band Power

**בעיה התחלתית:** שימוש ב-`np.sum()` נתן ערכים גבוהים מדי

**פתרון:** מעבר לאינטגרציה טרפזואידית (`np.trapz`)

### אתגר 4: אימות ללא מטופלים

**בעיה:** אין גישה למטופלים אמיתיים

**פתרון:** 
- פיתוח Motor Simulation עם reference מבוקר
- אימות בתנאים ריאליסטיים (חיישן על אצבע)
- השוואה כמותית: תדר מוזן vs תדר מזוהה

**הישג:** אימות עקרון הפעולה בדיוק של ±0.25 Hz

---

# .4 סיכום ודיון

## 4.1 הצורך בפרויקט

רעד פתולוגי משפיע על מיליוני בני אדם ברחבי העולם ומהווה אחד הסימפטומים השכיחים ביותר במחלות נוירולוגיות. המערכות הקיימות כיום לאבחון ומעקב אחר רעד הן:
- **יקרות מאוד** ($50,000-$200,000)
- **מסורבלות** (ציוד נייח במעבדה)
- **סובייקטיביות** (הערכת נוירולוג)
- **לא זמינות** למרבית המרפאות והחולים

פרויקט זה **מציג פתרון חדשני** המוכיח שניתן לבנות מערכת **זולה** (~$100), **ניידת**, **אובייקטיבית** ו**מבוססת מדעית** לזיהוי וסיווג רעד פתולוגי. המערכת שפותחה משיגה דיוק גבוה בסימולציה ריאליסטית ומספקת בסיס מוצק למחקר המשך.

---

## 4.2 סיכום ומסקנות

פרויקט זה השיג את מטרותיו בהצלחה ומדגים יישום מעשי של עיבוד אותות דיגיטלי מתקדם לזיהוי רעד פתולוגי. המערכת שפותחה מוכיחה שניתן לבנות פתרון זול, נייד ואמין לסיווג רעד ללא צורך בציוד מעבדתי יקר.

### הישגים עיקריים

**1. פיתוח מערכת רכישת נתונים יציבה:**
- דגימה מדויקת ב-100 Hz (±0.03 Hz)
- אובדן נתונים: 0%
- ממשק משתמש ידידותי

**2. פיתוח אלגוריתם DSP מתקדם:**
- סינון Butterworth Order 4 (48 dB/octave)
- ניתוח PSD בשיטת Welch (רזולוציה 0.25 Hz)
- סיווג מבוסס Power Ratio

**3. אימות כמותי:**
- דיוק זיהוי תדר: ±0.25 Hz (רזולוציית Welch)
- דיוק סיווג בתנאים ריאליסטיים: גבוה (חיישן על אצבע, יד אוחזת במנוע)
- דיוק סיווג כולל (120s): 100% (הסיווג הכולל נכון למרות דמפינג ביומכני)

**4. תיעוד מקיף:**
- ספר פרויקט מלא
- תיעוד טכני מפורט
- קוד מתועד ומודולרי

### מסקנות מדעיות

**1. Power Ratio הוא קריטריון אמין לסיווג:**
- הפרדה ברורה בין Rest (Ratio > 2.0) ל-Essential (Ratio < 0.5)
- עובד גם בנוכחות דמפינג ביומכני
- פשוט לחישוב ולפרשנות

**2. סינון Butterworth Order 4 מספק:**
- הפרדה טובה בין טווחי תדרים (>40 dB attenuation)
- פאזה ליניארית (zero-phase filtfilt)
- פשוט למימוש

**3. Welch PSD עם 4s windows מספק:**
- רזולוציה מספקת (0.25 Hz)
- שונות נמוכה (מיצוע על חלונות)
- מהיר לחישוב

**4. Motor Simulation הוכיחה את יעילות הגישה:**
- אימות מבוקר עם תדרים מוכרים (4-6 Hz, 8-10 Hz)
- סימולציה ריאליסטית - חיישן על אצבע + דמפינג ביומכני טבעי
- דיוק גבוה למרות תנאים לא אידיאליים
- בסיס מוצק לפיתוח המשך - מוכן למעבר לאימות קליני

### לקחים שנלמדו

**1. חשיבות הגדרות קליניות:**
- שימוש בטווחי תדרים קליניים מקובלים (3-7, 6-12 Hz)
- אי שינוי הגדרות למען "קלות" בסיווג
- תיעוד מגבלות בכנות

**2. חשיבות אימות בתנאים ריאליסטיים:**
- סימולציה עם דמפינג ביומכני מדגימה מצב אמיתי
- חשוב לבדוק robustness לשינויים פיזיולוגיים
- תיעוד תוצאות בפירוט כולל הגבלות ומגבלות

**3. חשיבות עיצוב מודולרי:**
- קל להוסיף תכונות חדשות
- קל לתקן באגים
- קל לתחזק

### אימות תכן vs אימות קליני

**מהו אימות תכן (Design Validation)?**

פרויקט זה מתמקד ב**אימות תכן** (Design Validation / Proof of Concept) של מערכת זיהוי וסיווג רעד.

**מטרת אימות התכן:**
לוודא שהמערכת ההנדסית מתפקדת כראוי - כלומר, מסוגלת לזהות תדרים בצורה מדויקת ולסווג אותם לפי הספרות המדעית:
- **תדרים ב-4-6 Hz** → סיווג Rest Tremor (טווח ספרותי: 3-7 Hz)
- **תדרים ב-8-10 Hz** → סיווג Essential Tremor (טווח ספרותי: 6-12 Hz)

**השיטה שלנו - Reference מבוקר:**

אמת המידה (Reference): תדר המנוע DC המבוקר באמצעות PWM

```
Input (Known)         →  System Processing  →  Output (Measured)
Motor: 5.0 Hz            MPU6050 + DSP         Detected: 5.25 Hz

Validation: Compare Input vs Output
Error = ±0.25 Hz ✅ (within Welch resolution)
```

המנוע מייצר רעידות בתדרים ידועים מראש (reference), והמערכת מזהה ומסווגת אותם. ההשוואה בין התדר הידוע (input) לתדר המזוהה (output) מאפשרת **אימות כמותי** של דיוק המערכת.

**מה הושג בפרויקט:**

✅ **אימות טכני מלא:**
- דיוק זיהוי תדר: ±0.25 Hz (בדיוק רזולוציית Welch התיאורטית)
- הוכחה שהאלגוריתם עובד בתנאים ריאליסטיים

✅ **בסיס מוצק לפיתוח המשך:**
- מערכת עובדת מקצה לקצה
- קוד מתועד ומודולרי
- תיעוד מלא של שרשרת העיבוד

**מה לא בוצע (עבודה עתידית):**

⏳ **אימות קליני (Clinical Validation):**
- בדיקה על מטופלים אמיתיים עם אבחנות מאושרות
- השוואה לאבחנה של נוירולוג (Gold Standard)
- דורש אישור IRB ושיתוף פעולה עם מוסד רפואי

**סיכום:** אימות תכן הוא שלב קריטי ומספיק לפרויקט גמר הנדסי. אימות קליני הוא שלב נפרד שדורש משאבים רפואיים ומחקריים נוספים.

---

## 4.3 תוספות עתידיות

### שיפורים טכניים

**1. Real-Time Analysis על ESP32:**
- מימוש DSP על ESP32 (במקום Raspberry Pi)
- הפחתת עלות וגודל המערכת
- תגובה מיידית (לא צריך Raspberry Pi)

**2. Adaptive Thresholds:**
- למידת ערכי baseline אישיים
- התאמת thresholds לפי משתמש
- שיפור דיוק לאוכלוסיות שונות

**3. Multi-Sensor Fusion:**
- הוספת ג'ירוסקופ (זווית סיבוב)
- הוספת מגנטומטר (כיוון בחלל)
- שיפור robustness

**4. Wireless Communication:**
- Bluetooth Low Energy (BLE) במקום USB
- WiFi streaming לענן
- אפליקציה ניידת

### שיפורים אלגוריתמיים

**5. Machine Learning:**
- שימוש בנתונים שנאספו (CSV files)
- למידה מפוקחת (Supervised Learning)
- סיווג מדויק יותר

**6. Feature Engineering:**
- הוספת מדדים נוספים (Entropy, Fractal Dimension, וכו')
- ניתוח temporal patterns
- זיהוי amplitude modulation

**7. Multi-Class Classification:**
- הוספת סוגי רעד נוספים (Cerebellar, Psychogenic, וכו')
- זיהוי תת-סוגים (Tremor Dominant vs Rigid Dominant Parkinson's)

### אימות קליני

**8. Clinical Validation:**
- שיתוף פעולה עם מחלקה נוירולוגית
- גיוס מטופלים עם אבחנות מאושרות
- השוואה ל-Gold Standard (הערכת נוירולוג)
- קבלת אישור IRB

**9. Longitudinal Studies:**
- מעקב אחר מטופלים לאורך זמן
- הערכת התקדמות מחלה
- הערכת יעילות טיפול

**10. Population Studies:**
- בדיקה על אוכלוסיות שונות (גיל, מין, גזע)
- בדיקה על חומרות שונות (mild, moderate, severe)
- בניית נורמות

---

## 4.4 עמידה בדרישות

**טבלה 9: סטטוס עמידה בדרישות הפרויקט**

| דרישה | ביצוע | סטטוס |
|-------|--------|-------|
| כתיבת הצעת פרויקט | הצעה מפורטת הוגשה | ✅ בוצע |
| פיתוח מערכת רכישה (ESP32 + MPU6050) | פותח ונבדק | ✅ בוצע |
| פיתוח אלגוריתם DSP (Butterworth, Welch) | פותח ונבדק | ✅ בוצע |
| פיתוח ממשק גרפי MATLAB-style | 4 Tabs עם navigation | ✅ בוצע |
| פיתוח מערכת אימות (Motor Simulation) | 2 sequences (Rest, Essential) | ✅ בוצע |
| אימות בתנאים ריאליסטיים (חיישן על אצבע) | דיוק גבוה | ✅ בוצע |
| תיעוד טכני מפורט | 3 מסמכי MD | ✅ בוצע |
| כתיבת ספר פרויקט | מסמך זה | ✅ בוצע |
| אימות קליני על מטופלים | לא בוצע (future work) | ⏳ עתידי |

**סיכום:**
הפרויקט השלים בהצלחה את **כל 8 הדרישות ההנדסיות** שהוגדרו:
- ✅ מערכת רכישה יציבה (0% אובדן נתונים)
- ✅ אלגוריתם DSP מתקדם (Butterworth + Welch)
- ✅ ממשק גרפי מקצועי (4-Tab MATLAB-style)
- ✅ מערכת אימות חכמה (Motor Simulation)
- ✅ דיוק גבוה בסימולציה ריאליסטית
- ✅ תיעוד מלא ומפורט

**השלב הבא:** הרחבה לאימות קליני על מטופלים (עבודה עתידית הדורשת שיתוף פעולה עם מוסדות רפואיים).

---

# .5 סימוכין

## מאמרים מדעיים

[1] M. Meigal et al., "Clinical Medicine: Tremor Analysis Using Wearable Sensors," *MDPI Clinical Medicine*, vol. 14, no. 6, article 2073, 2025. [Online]. Available: https://www.mdpi.com/2077-0383/14/6/2073

[2] S. Rodriguez et al., "ELENA Project: Wearable IMU for Tremor Assessment," *MDPI Sensors*, vol. 25, no. 9, article 2763, 2025. [Online]. Available: https://www.mdpi.com/1424-8220/25/9/2763

[3] G. Deuschl et al., "Consensus Statement on the Classification of Tremors," *Movement Disorders*, vol. 13, no. 1, pp. 2-23, 1998.

[4] E. D. Louis and J. J. Ferreira, "How common is the most common adult movement disorder? Update on the worldwide prevalence of essential tremor," *Movement Disorders*, vol. 25, no. 5, pp. 534-541, 2010.

[5] R. J. Elble, "What is essential tremor?," *Current Neurology and Neuroscience Reports*, vol. 13, article 353, 2013.

## ספרים

[6] S. W. Smith, *The Scientist and Engineer's Guide to Digital Signal Processing*, California Technical Publishing, 1997.

[7] A. V. Oppenheim and R. W. Schafer, *Discrete-Time Signal Processing*, 3rd ed., Prentice Hall, 2009.

[8] P. D. Welch, "The use of fast Fourier transform for the estimation of power spectra," *IEEE Transactions on Audio and Electroacoustics*, vol. 15, no. 2, pp. 70-73, 1967.

## תיעוד טכני

[9] Raspberry Pi Foundation, "Raspberry Pi 4 Model B Datasheet," 2023. [Online]. Available: https://datasheets.raspberrypi.org/rpi4/raspberry-pi-4-datasheet.pdf

[10] Espressif Systems, "ESP32 Technical Reference Manual," v4.8, 2024. [Online]. Available: https://www.espressif.com/sites/default/files/documentation/esp32_technical_reference_manual_en.pdf

[11] InvenSense, "MPU-6050 Product Specification," Rev. 3.4, 2013. [Online]. Available: https://invensense.tdk.com/wp-content/uploads/2015/02/MPU-6000-Datasheet1.pdf

[12] Texas Instruments, "L298N Dual H-Bridge Motor Driver Datasheet," 2000.

## תוכנה וספריות

[13] NumPy Developers, "NumPy Documentation," 2025. [Online]. Available: https://numpy.org/doc/

[14] SciPy Developers, "SciPy Documentation - Signal Processing," 2025. [Online]. Available: https://docs.scipy.org/doc/scipy/reference/signal.html

[15] Matplotlib Development Team, "Matplotlib Documentation," 2025. [Online]. Available: https://matplotlib.org/stable/contents.html

[16] Adafruit Industries, "Adafruit MPU6050 Library," GitHub, 2024. [Online]. Available: https://github.com/adafruit/Adafruit_MPU6050

## מסמכי פרויקט

[17] עומר פטיש, "הצעת פרויקט מעודכן לפרויקט יחיד," 2025.

[18] עומר פטיש, "SIGNAL_PROCESSING_CHAIN_EN.md - תיעוד שרשרת עיבוד אותות," 2026.

[19] עומר פטיש, "ANALYZER_IMPROVEMENTS.md - תיעוד שיפורי מנתח," 2026.

[20] עומר פטיש, "README.md - מערכת זיהוי רעד," 2026.

---
